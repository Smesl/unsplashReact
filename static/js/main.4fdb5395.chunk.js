(this["webpackJsonpmy-diplom"]=this["webpackJsonpmy-diplom"]||[]).push([[0],{25:function(t,e,o){t.exports={UnsplashImg:"Image_UnsplashImg__RYnsu"}},33:function(t,e,o){t.exports={myModal:"MyModal_myModal__1nutx",myModalContent:"MyModal_myModalContent__2jqx1",active:"MyModal_active__3H2ZP",listItem:"MyModal_listItem__2zmHd"}},4:function(t,e,o){t.exports={photoBackground:"PhotoDetail_photoBackground__BFzOK",photoList:"PhotoDetail_photoList__1rKgi",photoContainer:"PhotoDetail_photoContainer__1Tu-A",photoDetailContainer:"PhotoDetail_photoDetailContainer__1hzUQ",photoDetailContainerWrapper:"PhotoDetail_photoDetailContainerWrapper__1ClUs",photoDetailHeader:"PhotoDetail_photoDetailHeader__3Akwj",photoDetailFooter:"PhotoDetail_photoDetailFooter__2gTFI",photoDetailFooter_img:"PhotoDetail_photoDetailFooter_img__3-ZkZ",photoDetailFooter_author:"PhotoDetail_photoDetailFooter_author__3PSNo"}},64:function(t,e,o){"use strict";o.r(e);var a=o(1),n=o(0),r=o.n(n),i=o(16),s=o.n(i),c=o(2),l=o(14),h=o.n(l),u=o(17),p=o(18),g=o(20),j=o(19),d=o(8),b=o(25),m=o.n(b),O=o(33),_=o.n(O),f=new h.a({accessKey:"_lA3lHkE44r0DM1pEbgwrjXpFna7SrgNn4n3fSggVc8",secret:"D4mBhM0frM4mBFFrX8FF0Zb1cEf8lvQIRPW2PzZZt04"}),k=o(11),P=function(t){var e=t.photoImgThumb;return Object(a.jsx)("span",{children:Object(a.jsx)("img",{src:e,alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"})})},D=(o(60),o(4)),v=o.n(D),x=o.p+"static/media/notLike.b65bcc72.svg",I=o.p+"static/media/like.d29e4545.svg",L=function(t){console.log(t);var e=t.id,o=t.isLiked,n=t.likes,r=t.toggleLikeUser,i=v.a.photoDetailHeader;return Object(a.jsxs)("header",{className:i,children:[Object(a.jsx)("img",{src:o?I:x,onClick:function(){return r(e,o)},alt:"like Button"}),Object(a.jsxs)("span",{children:["likes ",n]})]})},T=function(t){console.log(t);var e=v.a.photoDetailFooter,o=v.a.photoDetailFooter_img,n=v.a.photoDetailFooter_author;return Object(a.jsx)("footer",{className:e,children:Object(a.jsxs)("a",{href:t.authorProfileLink,rel:"noopener noreferrer",target:"_blank",children:[Object(a.jsx)("span",{className:o,children:Object(a.jsx)("img",{src:t.authorProfileAvatar,alt:"\u0424\u043e\u0442\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044f"})}),Object(a.jsxs)("div",{className:n,children:[Object(a.jsx)("span",{children:t.authorName}),Object(a.jsx)("span",{children:t.createdPhoto})]})]})})},S=new h.a({apiRoot:"https://api.unsplash.com/",accessKey:"_lA3lHkE44r0DM1pEbgwrjXpFna7SrgNn4n3fSggVc8",secret:"D4mBhM0frM4mBFFrX8FF0Zb1cEf8lvQIRPW2PzZZt04",callbackUrl:"http://localhost:3000"}),F=S.auth.getAuthenticationUrl(["public","write_likes"]),y=function(t){Object(g.a)(o,t);var e=Object(j.a)(o);function o(){return Object(u.a)(this,o),e.apply(this,arguments)}return Object(p.a)(o,[{key:"render",value:function(){console.log(S);var t=v.a.photoDetailContainerWrapper;v.a.photoDetailContainer;console.log(this.props);var e=this.props,o=e.photo,n=(e.togglePhotoDetailStatus,e.photoDetailStatus),r=e.toggleLikeUser;console.log(o),console.log(n);var i=o[0],s=i.photoImgThumb,c=i.isLiked,l=i.id,h=i.likes,u=i.authorName,p=i.createdPhoto,g=i.authorProfileLink,j=i.authorProfileAvatar;return Object(a.jsxs)("div",{className:t,children:[Object(a.jsx)(L,{isLiked:c,id:l,likes:h,toggleLikeUser:r}),Object(a.jsx)(P,{photoImgThumb:s}),Object(a.jsx)(T,{authorProfileLink:g,authorName:u,createdPhoto:p,authorProfileAvatar:j})]})}}]),o}(r.a.Component),E=Object(k.compose)(c.g,Object(d.b)((function(t){return{dataPhoto:t.photos,photoDetailStatus:t.status.photoDetailStatus}}),{toggleLikeUser:function(t,e){console.log(t,e,f);var o=localStorage.getItem("token");return console.log(o),f.auth.setBearerToken(o),console.log(f),function(o){(e?f.photos.unlikePhoto(t):f.photos.likePhoto(t)).then((function(t){return console.log(t.json())})).then((function(){o(function(t){return{type:"TOGGLE_LIKE",id:t}}(t))})).catch((function(t){console.log("\u041e\u0428\u0418\u0411\u041a\u0410!!! ".concat(t))}))}},togglePhotoDetailStatus:function(){return{type:"TOGGLE_IS_PHOTO_DETAIL_STATUS"}}}))((function(t){console.log(t);var e=t.dataPhoto,o=t.photos,n=t.photoDetailStatus,r=t.togglePhotoDetailStatus,i=t.toggleLikeUser;console.log(o),console.log(n);var s=o.match.params.id;console.log(s);var c=e.photo.filter((function(t){return t.id===s}));console.log(c);var l=v.a.photoDetailContainerWrapper;v.a.photoDetailContainer;return Object(a.jsx)(y,{className:l,photo:c,photoDetailStatus:n,togglePhotoDetailStatus:r,toggleLikeUser:i})})),C=o(13),N=function(t){var e=t.photoImgThumb,o=t.id,n=m.a.UnsplashImg;return Object(a.jsx)("div",{className:n,children:Object(a.jsxs)(C.b,{to:"".concat(o),children:[Object(a.jsx)("img",{src:e,alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"})," "]})})},M=function(t){var e=t.photo,o=(e.photoImgSmall,e.photoImgThumb),n=e.id;Object(d.c)();return Object(a.jsx)("li",{className:_.a.listItem,children:Object(a.jsx)(N,{photoImgThumb:o,id:n})})},w=(o(62),function(t){Object(g.a)(o,t);var e=Object(j.a)(o);function o(t){var a;return Object(u.a)(this,o),(a=e.call(this,t)).lastElement=Object(n.createRef)(),a}return Object(p.a)(o,[{key:"render",value:function(){console.log(this.lastElement);var t=this.props,e=t.dataPhoto,o=(t.toggleLikeUser,t.getPhoto,t.currentPage),n=(t.isFetching,t.fetchPhoto),r=v.a.photoList,i=v.a.photoContainer;return console.log(this.props),Object(a.jsxs)("div",{className:i,children:[Object(a.jsx)("button",{onClick:function(){return n(o)},children:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0444\u043e\u0442\u043e"}),Object(a.jsx)("ul",{className:r,children:e.map((function(t){return Object(a.jsx)(M,{photo:t},t.id)}))})]})}}]),o}(r.a.Component)),G=Object(d.b)((function(t){return{dataPhoto:t.photos.photo,currentPage:t.photos.currentPage,isFetching:t.status.isFetching}}),{fetchPhoto:function(t){return function(e){e({type:"TOGGLE_IS_FETCHING"}),f.photos.listPhotos(t,10,"latest").then((function(t){return t.json()})).then((function(t){return e(function(t){return{type:"GET_PHOTO",photos:(e=t,e.map((function(t){return{id:t?t.id:"",createdPhoto:t?t.created_at:"",isLiked:t?t.liked_by_user:"",likes:t?t.likes:"0",photoImgThumb:t&&t.urls?t.urls.small:"",photoImgSmall:t&&t.urls?t.urls.thumb:"",authorName:t&&t.user?t.user.name:"",authorProfileLink:t&&t.user&&t.user.links?t.user.links.html:"",authorProfileAvatar:t&&t.user&&t.user.profile_image?t.user.profile_image.small:""}})))};var e}(t))})).catch((function(t){console.log("\u041e\u0428\u0418\u0411\u041a\u0410!!! ".concat(t))}))}}})(w),U=function(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(c.c,{children:[Object(a.jsx)(c.a,{exact:!0,path:"/",component:G}),Object(a.jsx)(c.a,{exact:!0,path:"/:id",render:function(t){return Object(a.jsx)(E,{photos:t})}})]})})},A=o(34),H=o(35),B=o(21),Z=o(9),W={photo:[],currentPage:1},K={isFetching:!1,photoDetailStatus:!1},R=Object(k.combineReducers)({photos:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"GET_PHOTO":return Object(Z.a)(Object(Z.a)({},t),{},{photo:[].concat(Object(B.a)(t.photo),Object(B.a)(e.photos)),currentPage:t.currentPage+1});case"TOGGLE_LIKE":var o=Object(B.a)(t.photo),a=o.findIndex((function(t){return t.id===e.id}));return o[a].isLiked=!o[a].isLiked,o[a].isLiked?o[a].likes++:o[a].likes--,Object(Z.a)(Object(Z.a)({},t),{},{photo:o});default:return t}},status:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"TOGGLE_IS_PHOTO_DETAIL_STATUS":return Object(Z.a)(Object(Z.a)({},t),{},{photoDetailStatus:!t.photoDetailStatus});case"TOGGLE_IS_FETCHING":return Object(Z.a)(Object(Z.a)({},t),{},{isFetching:!t.isFetching});default:return t}}}),z=Object(k.createStore)(R,Object(A.composeWithDevTools)(Object(k.applyMiddleware)(H.a))),X=window.location.search.split("code=")[1];console.log(X),console.log(S),X?S.auth.userAuthentication(X).then((function(t){return t.json()})).then((function(t){localStorage.setItem("token",t.access_token),S.auth.setBearerToken(t.access_token)})).then(window.history.pushState(null,null,"/")).then(s.a.render(Object(a.jsx)(d.a,{store:z,children:Object(a.jsx)(C.a,{children:Object(a.jsx)(U,{})})}),document.getElementById("root"))):window.location.assign(F)}},[[64,1,2]]]);
//# sourceMappingURL=main.4fdb5395.chunk.js.map